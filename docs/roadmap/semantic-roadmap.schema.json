{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://bioregionalknowledgecommons.org/schema/semantic-roadmap.schema.json",
  "title": "Semantic Roadmap",
  "description": "Canonical machine-readable roadmap graph for Bioregional Knowledge Commoning.",
  "type": "object",
  "required": [
    "roadmap_id",
    "program",
    "version",
    "as_of",
    "nodes",
    "edges"
  ],
  "additionalProperties": false,
  "properties": {
    "@context": {
      "type": "string",
      "description": "Optional JSON-LD context reference."
    },
    "roadmap_id": {
      "type": "string",
      "pattern": "^[a-z0-9][a-z0-9._:-]{2,}$"
    },
    "program": {
      "type": "string",
      "minLength": 1
    },
    "version": {
      "type": "string",
      "pattern": "^\\d+\\.\\d+\\.\\d+$"
    },
    "as_of": {
      "type": "string",
      "format": "date"
    },
    "owners": {
      "type": "array",
      "items": {
        "$ref": "#/$defs/owner"
      }
    },
    "nodes": {
      "type": "array",
      "minItems": 1,
      "items": {
        "$ref": "#/$defs/node"
      }
    },
    "edges": {
      "type": "array",
      "items": {
        "$ref": "#/$defs/edge"
      }
    }
  },
  "$defs": {
    "owner": {
      "type": "object",
      "required": [
        "id",
        "name"
      ],
      "additionalProperties": false,
      "properties": {
        "id": {
          "type": "string",
          "pattern": "^[a-z0-9][a-z0-9._:-]{2,}$"
        },
        "name": {
          "type": "string",
          "minLength": 1
        },
        "role": {
          "type": "string"
        }
      }
    },
    "node": {
      "type": "object",
      "required": [
        "id",
        "kind",
        "title",
        "status"
      ],
      "additionalProperties": false,
      "properties": {
        "id": {
          "type": "string",
          "pattern": "^[a-z0-9][a-z0-9._:-]{2,}$"
        },
        "kind": {
          "type": "string",
          "enum": [
            "outcome",
            "initiative",
            "work_item",
            "decision",
            "risk",
            "milestone",
            "metric"
          ]
        },
        "title": {
          "type": "string",
          "minLength": 1
        },
        "summary": {
          "type": "string"
        },
        "status": {
          "type": "string",
          "enum": [
            "planned",
            "in_progress",
            "blocked",
            "done",
            "deprecated"
          ]
        },
        "priority": {
          "type": "string",
          "enum": [
            "P0",
            "P1",
            "P2",
            "P3"
          ]
        },
        "horizon": {
          "type": "string",
          "enum": [
            "0-30d",
            "30-90d",
            "90-180d",
            "180-365d"
          ]
        },
        "owner": {
          "type": "string",
          "pattern": "^[a-z0-9][a-z0-9._:-]{2,}$"
        },
        "due_date": {
          "type": "string",
          "format": "date"
        },
        "tags": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          }
        },
        "source_docs": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          }
        },
        "metadata": {
          "type": "object",
          "additionalProperties": true
        }
      }
    },
    "edge": {
      "type": "object",
      "required": [
        "from",
        "to",
        "type"
      ],
      "additionalProperties": false,
      "properties": {
        "from": {
          "type": "string",
          "pattern": "^[a-z0-9][a-z0-9._:-]{2,}$"
        },
        "to": {
          "type": "string",
          "pattern": "^[a-z0-9][a-z0-9._:-]{2,}$"
        },
        "type": {
          "type": "string",
          "enum": [
            "depends_on",
            "delivers",
            "mitigates",
            "informs",
            "blocks",
            "references",
            "measures"
          ]
        },
        "note": {
          "type": "string"
        }
      }
    }
  }
}
